<VirtualHost *:80>
    ServerName web3.bon-soleil.com
    ServerAlias www.web3.bon-soleil.com

    DocumentRoot /var/www/html/web3.bon-soleil.com

    # Enable mod_rewrite
    RewriteEngine On

    # Redirect HTTP to HTTPS
    RewriteCond %{HTTPS} off
    RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

    ErrorLog logs/web3.bon-soleil.com_error.log
    CustomLog logs/web3.bon-soleil.com_access.log combined
</VirtualHost>

<VirtualHost *:443>
    ServerName web3.bon-soleil.com
    DocumentRoot /var/www/html/web3.bon-soleil.com
    ErrorLog logs/web3.bon-soleil.com_error.log
    CustomLog logs/web3.bon-soleil.com_access.log combined

    # SSL Configuration
    SSLEngine on
    SSLProxyEngine On

    # API Gateway proxy
    ProxyPass /api/ https://328qde9qs5.execute-api.ap-northeast-1.amazonaws.com/api/
    ProxyPassReverse /api/ https://328qde9qs5.execute-api.ap-northeast-1.amazonaws.com/api/

    # Geth RPC proxy
    ProxyPass /geth http://localhost:8545
    ProxyPassReverse /geth http://localhost:8545

    # SSL Certificate Configuration
    SSLCertificateFile /etc/letsencrypt/live/web3.bon-soleil.com/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/web3.bon-soleil.com/privkey.pem
</VirtualHost>

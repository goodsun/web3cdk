# Claude Code Configuration

## (重要)プロジェクトの目的
ベストプラクティスな方法でcdkを効率的に立ち上げるツール郡を構築したい。
シンプルで確実な方法で一歩一歩進める。

### 🎯 プロジェクト構成の設計思想

#### 初学者フレンドリーな構成
- **ルートディレクトリはすっきり**: 重要なファイル（package.json、README.md）のみ
- **役割別のディレクトリ分け**: 何がどこにあるか一目で分かる
- **設定ファイルの集約**: 散らばりがちな設定ファイルを整理

#### ディレクトリ構成の原則
```
web3cdk/
├── 📋 プロジェクト管理 (ルート)
├── 📁 ソースコード (src/)
├── 📁 開発・運用 (scripts/, test/, docs/)
└── 📁 設定ファイル (config/, tools/)
```

#### 設計のメリット
1. **学習コスト削減**: 新しい開発者が迷わない
2. **保守性向上**: ファイルの配置が論理的
3. **拡張性**: 新しいファイルの置き場所が明確
4. **プロフェッショナル**: 整理された印象を与える

### 🎯 初学者と上級者のバランス設計思想

#### 基本方針：「初学者ファースト、上級者配慮」
- **メイン機能**: 初学者が迷わないシンプルなコマンド
- **拡張機能**: 上級者向けはTipsやコラムとして紹介
- **学習段階**: 段階的にスキルアップできる設計

#### コマンド設計の考え方
```
🎓 初学者向け（メイン）:
  npm run deploy:dev    # 簡単！分かりやすい！
  npm run diff:prod     # 何をするか一目瞭然！

🚀 上級者向け（Tips）:
  npx cdk deploy stack-name    # 柔軟性重視
  npx cdk diff --all          # 詳細制御
```

#### ドキュメント構成の原則
1. **メインフロー**: 初学者向けの手順を分かりやすく
2. **上級者Tips**: 「💡 上級者向けTips」として分離
3. **学習の橋渡し**: 「慣れてきたら〜も試してみてください」で案内

#### この設計により実現すること
- **初学者**: 迷わず使える、成功体験を得られる
- **上級者**: 必要な情報は得られる、制限を感じない
- **プロジェクト**: シンプルさを保ちつつ、拡張性も確保

## 🎯 Development Mode Settings

**現在慎重モード** 
<!-- 現在高速モード / 現在慎重モード のどちらかを記載 -->

### モード切り替え方法
```
# 高速モードに切り替え
"高速モードに切り替えて"

# 慎重モードに切り替え  
"慎重モードに切り替えて"
```

**モード切り替え時は、Claude が CLAUDE.md の「現在○○モード」部分を自動更新します**

### 🚀 高速モード (Fast Development Mode)
- ソースコード変更を確認なしで実行
- アイデアを素早く形にすることを優先
- 複数の修正を連続して適用
- エラーが出たら修正して継続

### 🔍 慎重モード (Careful Development Mode)  
- ソースコード変更前に毎回確認を求める
- 一つずつ丁寧に変更内容を説明
- ユーザーの承認後に変更を実行
- 重要な修正や本番環境では必須

### Claude Code 標準の確認動作

#### 📋 DRY原則の厳守 (Don't Repeat Yourself)
- **重複コードの排除**: 同じロジックは関数・クラス・モジュールとして切り出す
- **設定の一元化**: 定数・設定値は一箇所で管理し、複数箇所で参照
- **共通処理の抽象化**: 似たような処理は共通関数として実装
- **コピー&ペーストの禁止**: 既存コードをコピーする前に共通化を検討
- **リファクタリングの推奨**: 重複が発見された場合は積極的に統合

#### 🔒 常に確認が必要な操作（モードに関係なく）
- **危険なコマンド**: `rm -rf`, `sudo`, `chmod +x` など
- **Git操作**: `git push`, `git reset --hard`, `git clean -fd`
- **パッケージインストール**: `npm install`, `pip install` 
- **環境変数の変更**: `.env` ファイルの編集
- **データベース操作**: DROP, DELETE, TRUNCATE など
- **ファイル削除**: 既存ファイルの削除

#### ⚡ 高速モードで確認をスキップする操作
- **ファイル作成・編集**: 新規ファイル作成、既存ファイルの修正
- **TypeScript/JavaScript**: コード追加・修正
- **設定ファイル**: package.json, tsconfig.json の更新
- **ドキュメント**: README, CLAUDE.md の更新
- **開発用コマンド**: `npm run build`, `npm test`
- **ローカルデプロイ**: `./deploy.sh local` （Discord機能以外）
- **Discord本番デプロイ**: `./deploy.sh production` （Discord機能専用）

#### 🔍 慎重モードで追加確認する操作
- **全てのファイル編集**: 内容を説明してから実行
- **コマンド実行**: 実行内容を説明してから実行
- **複数ファイル一括変更**: 影響範囲を説明してから実行
- **API仕様変更**: 破壊的変更の可能性を説明

#### 📋 確認メッセージの例
```
慎重モード時:
「app.ts に Discord EOA 機能を追加します。
 - 新しいエンドポイント /discord/member/:userId を追加
 - DynamoDB から EOA 情報を取得する処理を追加
実行してよろしいですか？」

高速モード時:
（確認なしで即座に実行）
```

## ⚠️ 重要な教訓

### 🚨 ユーザーの指示を必ず従う
- **ユーザーが「まずは〇〇」と言ったら、必ずその順序で実行する**
- **「シンプルで確実な方法で一歩一歩」と言われたら、複雑化しない**
- **勝手に機能を追加したり、指示を無視してはいけない**

### 📝 失敗例
```
ユーザー: 「まずはbootstrap」
Claude: setup.sh に bootstrap を混ぜ込んだ（間違い）

正解: bootstrap を単独で実行し、その後で setup を分離する
```

### ✅ 正しいアプローチ
1. **指示を正確に理解する**
2. **余計な機能を追加しない**
3. **確認してから進める**
4. **シンプルを保つ**
